# 自动保存功能使用指南

## 功能概述

自动保存功能让配置翻译服务变得更加简单快捷。验证配置成功后，系统会自动保存配置，无需手动点击保存按钮。

## 主要特性

### 1. 自动保存
- ✅ 验证成功后自动保存配置
- ✅ 实时 Toast 提示反馈
- ✅ 保存失败时显示浮动保存按钮

### 2. 智能配置建议
- ✅ 启用有道翻译后自动提示启用有道 TTS
- ✅ 一键启用相关功能
- ✅ 可忽略不需要的建议

### 3. 用户自定义
- ✅ 可关闭自动保存功能
- ✅ 可关闭配置建议
- ✅ 可关闭浮动保存按钮

## 使用方法

### 快速配置流程

1. **打开配置页面**
   - 点击扩展图标 → 设置

2. **配置翻译服务**
   - 选择翻译服务（如有道翻译）
   - 输入 AppID 和 AppSecret
   - 点击"验证"按钮

3. **自动完成**
   - 看到 Toast 提示"配置已自动保存" ✅
   - 如果有相关建议，会显示配置建议卡片
   - 点击"一键启用"即可启用相关功能

### 自定义设置

在配置页面底部找到"⚙️ 保存设置"区域：

```
☑ 验证成功后自动保存配置
☑ 显示配置建议提示
☑ 显示浮动保存按钮
```

根据需要勾选或取消勾选选项，然后点击"保存所有设置"。

## 配置建议

### 有道翻译 + 有道 TTS

当你配置好有道翻译后，系统会自动检测并提示：

```
💡 您已启用有道翻译服务，是否同时启用有道语音合成功能？
使用有道 TTS 可以获得更自然的中英文语音效果。

[一键启用]  [稍后配置]
```

点击"一键启用"后，系统会：
1. 自动配置有道 TTS
2. 启用语音合成功能
3. 保存配置
4. 更新 UI

## Toast 通知说明

### 通知类型

- **蓝色 (ℹ️)**: 信息提示
- **绿色 (✅)**: 成功提示
- **红色 (❌)**: 错误提示
- **橙色 (⚠️)**: 警告提示

### 常见提示

| 提示内容 | 含义 |
|---------|------|
| ⏳ 正在保存配置... | 配置正在保存中 |
| ✅ 配置已自动保存 | 配置保存成功 |
| ❌ 保存失败，请手动保存 | 保存失败，需要手动操作 |
| ✅ 有道语音合成已启用 | TTS 启用成功 |

## 浮动保存按钮

### 何时显示

- 保存失败时
- 关闭自动保存功能时
- 有未保存的更改时

### 如何使用

1. 点击右下角的"💾 保存配置"按钮
2. 等待保存完成
3. 看到"✅ 已保存"提示

## 常见问题

### Q: 如何关闭自动保存？

A: 在配置页面底部找到"保存设置"区域，取消勾选"验证成功后自动保存配置"，然后点击"保存所有设置"。

### Q: 配置建议会重复显示吗？

A: 不会。如果你点击了"稍后配置"或关闭按钮，该建议不会再次显示。

### Q: 如何重新显示已忽略的建议？

A: 清除浏览器的 localStorage 数据，或者在开发者工具中执行：
```javascript
localStorage.removeItem('dismissedSuggestions');
```

### Q: 保存失败怎么办？

A: 系统会自动显示浮动保存按钮，点击该按钮重试保存。如果仍然失败，请检查网络连接或浏览器权限。

### Q: 首次使用提示如何关闭？

A: 首次使用提示会在 5 秒后自动消失，且只显示一次。

## 技术细节

### 存储位置

- **用户偏好**: `chrome.storage.sync`
- **忽略的建议**: `localStorage`
- **首次使用标记**: `localStorage`

### 配置项

```typescript
interface AutoSavePreferences {
  autoSaveEnabled: boolean;      // 默认: true
  showSuggestions: boolean;      // 默认: true
  showFloatingButton: boolean;   // 默认: true
}
```

### API

```typescript
// 启用/禁用自动保存
autoSaveManager.enableAutoSave();
autoSaveManager.disableAutoSave();

// 启用/禁用配置建议
autoSaveManager.enableSuggestions();
autoSaveManager.disableSuggestions();

// 启用/禁用浮动按钮
autoSaveManager.enableFloatingButton();
autoSaveManager.disableFloatingButton();
```

## 反馈与支持

如果你遇到问题或有建议，请：
1. 查看 [实施总结](./IMPLEMENTATION_SUMMARY.md)
2. 查看 [PRD 文档](./prd/settings-auto-save-optimization.md)
3. 提交 Issue 或 Pull Request

---

**版本**: v1.0.0  
**最后更新**: 2025-10-17
