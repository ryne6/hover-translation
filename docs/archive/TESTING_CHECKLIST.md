# 测试检查清单

> ⚠️ 本文档提供详细场景参考。整体测试策略请参阅 `docs/guides/DEVELOPER_HANDBOOK.md`。

## 📋 安装后验证

### 1. 扩展安装验证 ✓

- [ ] 在 `chrome://extensions/` 中看到 "Hover Translation" 扩展
- [ ] 扩展图标显示在工具栏（紫色渐变图标）
- [ ] 扩展状态为"已启用"
- [ ] 无错误提示

### 2. 弹出窗口（Popup）样式验证 ✓

**打开方式**: 点击工具栏上的扩展图标

**检查项目**:
- [ ] 弹出窗口正常打开（约 400px 宽）
- [ ] 头部显示紫色渐变 Logo
- [ ] 标题 "Hover Translation" 和版本号显示正确
- [ ] 所有表单元素有正确的样式：
  - [ ] 下拉框（目标语言、源语言）有边框和圆角
  - [ ] 单选按钮（翻译服务）样式正确
  - [ ] 主题切换按钮有圆角和背景色
  - [ ] 复选框样式正确
- [ ] 底部按钮（保存设置、重置）有样式
- [ ] 数据统计区域显示正确
- [ ] 字体、间距、颜色都正常

**验证方法**:
```
如果看到：
✅ 所有元素有边框、圆角、阴影等样式
✅ 颜色协调（紫色主题）
✅ 文字清晰可读

❌ 如果所有元素都是默认浏览器样式（无边框、无颜色）
   → 说明 popup.css 未加载
```

### 3. 内容页面（Content）样式验证 ✓

**打开方式**: 访问任意网页（如 google.com）

#### 3.1 悬浮框样式

**操作**: 在页面上选择一段英文文本

**检查项目**:
- [ ] 出现半透明悬浮框
- [ ] 悬浮框有圆角（border-radius）
- [ ] 悬浮框有阴影（box-shadow）
- [ ] 悬浮框有毛玻璃效果（backdrop-filter blur）
- [ ] 头部区域有浅色背景
- [ ] 语言指示器显示正确（如 EN → 中文）
- [ ] 工具栏图标按钮可见（复制、发音、关闭）
- [ ] 图标按钮 hover 时有背景色变化
- [ ] 原文和译文区域有标签（原文、译文）
- [ ] 译文使用紫色字体
- [ ] 底部显示翻译服务提供商
- [ ] 整体布局整洁、间距合理

**验证方法**:
```
如果看到：
✅ 半透明白色悬浮框，带毛玻璃效果
✅ 圆角、阴影、渐变动画
✅ 按钮有 hover 效果

❌ 如果是纯白色方框，无任何样式
   → 说明 content.css 或相关样式未加载
```

#### 3.2 通知样式

**操作**: 点击悬浮框上的复制按钮

**检查项目**:
- [ ] 右上角出现通知（绿色背景）
- [ ] 通知从右侧滑入（动画效果）
- [ ] 通知文字清晰可读："翻译已复制到剪贴板"
- [ ] 通知有圆角和阴影
- [ ] 3秒后自动消失

### 4. 浏览器控制台检查 ✓

**打开方式**: 按 F12 或右键 → 检查

#### 4.1 内容页面控制台

**检查项目**:
- [ ] 无红色错误信息
- [ ] 看到初始化日志：
  ```
  TextSelector initialized
  HoverBox created
  HoverTranslation initialized
  ```
- [ ] 无 CSS 加载失败错误
- [ ] 无 "Cannot read properties of undefined" 错误

#### 4.2 扩展后台控制台

**打开方式**: `chrome://extensions/` → Hover Translation → "service worker (inactive)"

**检查项目**:
- [ ] 看到初始化日志：
  ```
  Background service initialized
  ```
- [ ] 无 Storage API 错误

#### 4.3 Popup 控制台

**打开方式**: 右键扩展图标 → 检查弹出式窗口

**检查项目**:
- [ ] 无 CSS 文件 404 错误
- [ ] 看到初始化日志：
  ```
  Popup initialized
  Settings loaded: {...}
  ```

### 5. 样式文件检查 ✓

**打开方式**: `chrome://extensions/` → Hover Translation → "查看视图"

**检查 dist 目录**:
```
dist/
├── styles/
│   ├── variables.css    ← 必须存在
│   ├── hover-box.css    ← 必须存在
│   ├── content.css      ← 必须存在
│   └── popup.css        ← 必须存在
```

**验证方法**:
```bash
ls -la dist/styles/
# 应该看到 4 个 CSS 文件
```

### 6. 功能测试 ✓

- [ ] **文本选择**: 选择文本后显示翻译
- [ ] **复制功能**: 点击复制按钮，文本复制到剪贴板
- [ ] **关闭悬浮框**: 
  - [ ] 点击关闭按钮
  - [ ] 按 ESC 键
  - [ ] 点击页面其他位置
- [ ] **设置保存**: 更改设置后保存，刷新页面设置保持
- [ ] **历史记录**: 查看翻译历史
- [ ] **缓存**: 相同文本第二次翻译更快

## 🐛 常见问题排查

### 问题 1: 弹出窗口无样式

**症状**: 点击扩展图标，弹出的窗口是纯白色，没有任何样式

**原因**: `popup.css` 未加载或路径错误

**解决**:
1. 检查 `dist/styles/popup.css` 是否存在
2. 检查 `dist/popup.html` 中的路径：
   ```html
   <link rel="stylesheet" href="styles/popup.css">
   ```
3. 重新构建: `npm run build`
4. 重新加载扩展

### 问题 2: 悬浮框无样式

**症状**: 选择文本后出现白色方框，没有圆角、阴影等效果

**原因**: CSS 文件未正确加载到内容页面

**解决**:
1. 检查 `dist/manifest.json` 中的 content_scripts:
   ```json
   "css": [
     "styles/variables.css",
     "styles/hover-box.css",
     "styles/content.css"
   ]
   ```
2. 确认这 3 个文件都存在于 `dist/styles/` 目录
3. 重新加载扩展并刷新测试页面

### 问题 3: Chrome Storage API 错误

**症状**: 控制台显示 "Cannot read properties of undefined (reading 'local')"

**原因**: Chrome API 在某些环境下不可用

**解决**:
1. 确保在 Chrome 浏览器中运行（不是 Firefox 或其他）
2. 确保扩展正确安装
3. 检查代码中是否有 Chrome API 检查：
   ```javascript
   if (typeof chrome !== 'undefined' && chrome.storage) {
     // 使用 chrome.storage
   }
   ```

### 问题 4: 样式冲突

**症状**: 悬浮框样式被页面样式覆盖

**特征**: 在某些网站上样式正常，某些网站上异常

**解决**:
- 已在 `content.css` 中添加高优先级选择器
- 使用 `!important` 确保关键样式
- z-index 设置为最大值 (2147483647)

## ✅ 全部通过的标志

如果以上所有检查项都通过，你应该看到：

1. **弹出窗口**: 美观的紫色主题设置面板
2. **悬浮框**: 半透明毛玻璃效果的翻译框
3. **通知**: 绿色滑入式通知
4. **无错误**: 控制台无红色错误
5. **功能正常**: 所有翻译和交互功能工作正常

## 📸 预期效果参考

### 弹出窗口应该像这样:
```
┌─────────────────────────────┐
│ [Logo] Hover Translation    │
│        v0.1.0               │
├─────────────────────────────┤
│ 翻译设置                     │
│ 目标语言 [简体中文 ▼]        │
│ 源语言   [自动检测 ▼]        │
│ ○ Google 翻译  ○ 百度翻译    │
├─────────────────────────────┤
│ [保存设置] [重置]            │
└─────────────────────────────┘
```

### 悬浮框应该像这样:
```
┌─────────────────────────────┐
│ EN → 中文        [📋][🔊][×]│
├─────────────────────────────┤
│ 原文                         │
│ Hello World                 │
│                             │
│ 译文                         │
│ 你好世界                     │
├─────────────────────────────┤
│ 由 Google 翻译提供           │
└─────────────────────────────┘
```

---

**如果遇到任何问题，请查看**: 
- [INSTALLATION.md](./INSTALLATION.md) - 安装指南
- [CHANGELOG.md](./CHANGELOG.md) - 更新日志
- 浏览器控制台错误信息
