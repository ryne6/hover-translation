# 多翻译引擎使用指南

## 🎯 概述

Hover Translation v0.2.0 现在支持 **9 种翻译服务**，采用先进的适配器架构，提供：
- ✅ 灵活的服务切换
- ✅ 自动降级容错
- ✅ 智能服务选择
- ✅ 并行翻译对比
- ✅ 详细的使用统计

## 📋 支持的翻译服务

### 传统翻译服务

#### 1. Google Translate (Google 翻译)
- **优势**: 支持 100+ 语言，质量稳定
- **适用场景**: 通用翻译，大多数语言对
- **配置**: 需要 Google Cloud API Key
- **费用**: $20/百万字符
- **获取 API Key**: https://cloud.google.com/translate

#### 2. DeepL
- **优势**: 翻译质量最高，最接近人工翻译
- **适用场景**: 欧洲语言互译，对质量要求高的场景
- **配置**: 需要 DeepL API Key
- **费用**: 免费版 50万字符/月，Pro $5.49/月起
- **获取 API Key**: https://www.deepl.com/pro-api

#### 3. 百度翻译
- **优势**: 中文翻译质量高，国内访问快
- **适用场景**: 中英互译，中文内容翻译
- **配置**: 需要 APP ID 和密钥
- **费用**: 标准版 5万字符/月免费
- **获取密钥**: https://fanyi-api.baidu.com

#### 4. Microsoft Translator
- **优势**: 企业级可靠性，支持 90+ 语言
- **适用场景**: 企业用户，多语言支持
- **配置**: 需要 Azure 订阅密钥和区域
- **费用**: 前 200万字符/月免费
- **获取密钥**: https://azure.microsoft.com/services/cognitive-services/translator

#### 5. 有道翻译
- **优势**: 中英互译质量高，教育场景优化
- **适用场景**: 学习、教育场景
- **配置**: 需要应用 ID 和应用密钥
- **费用**: 新用户 100元体验金
- **获取密钥**: https://ai.youdao.com

#### 6. 腾讯翻译
- **优势**: 性价比高，价格便宜
- **适用场景**: 大量翻译需求，成本敏感用户
- **配置**: 需要 SecretId 和 SecretKey
- **费用**: 前 500万字符/月免费
- **获取密钥**: https://cloud.tencent.com/product/tmt

### AI 翻译服务

#### 7. OpenAI GPT
- **优势**: 理解上下文，翻译最自然，可自定义风格
- **适用场景**: 需要高质量、自然表达的翻译
- **配置**: 需要 OpenAI API Key
- **费用**: GPT-3.5 $0.002/1K tokens, GPT-4 $0.03/1K tokens
- **获取 API Key**: https://platform.openai.com

#### 8. Claude AI
- **优势**: 长文本翻译优秀，100K token 上下文
- **适用场景**: 长文章翻译，文档翻译
- **配置**: 需要 Anthropic API Key
- **费用**: Sonnet $11.02/百万 tokens
- **获取 API Key**: https://console.anthropic.com

#### 9. Google Gemini
- **优势**: 免费额度高，响应速度快
- **适用场景**: 日常使用，成本敏感用户
- **配置**: 需要 Google AI API Key
- **费用**: Gemini 1.5 Flash 免费
- **获取 API Key**: https://ai.google.dev

## 🚀 快速开始

### 步骤 1: 选择翻译服务

1. 点击浏览器工具栏的扩展图标
2. 进入"翻译服务"标签页
3. 浏览可用的翻译服务
4. 选择至少一个服务并配置

### 步骤 2: 配置 API Key

**Google Translate 示例**:
1. 点击 Google 翻译卡片展开配置
2. 输入您的 API Key
3. 点击"验证"按钮
4. 看到"✓ 验证成功"后，启用开关

**免费服务推荐**:
- **Gemini 1.5 Flash**: 完全免费，适合日常使用
- **DeepL Free**: 每月 50万字符免费
- **百度翻译**: 每月 5万字符免费

### 步骤 3: 设置主要服务

1. 在"主要翻译服务"下拉框中选择默认使用的服务
2. 推荐配置：
   - 中英互译 → 百度翻译
   - 欧洲语言 → DeepL
   - 需要最高质量 → OpenAI GPT-4
   - 日常使用 → Gemini Flash (免费)

### 步骤 4: 配置备用服务（可选）

1. 启用"自动降级"开关
2. 当主服务失败时，自动切换到备用服务
3. 推荐配置：
   - 主服务: DeepL
   - 备用: Google → 百度 → Gemini

### 步骤 5: 保存并使用

1. 点击"保存设置"按钮
2. 在任何网页选择文本
3. 自动显示翻译结果
4. 查看"使用统计"了解各服务的使用情况

## ⚙️ 高级配置

### 翻译风格

在"高级选项"标签中可以设置：
- **默认**: 保持原文风格
- **正式**: 使用正式、礼貌的语言
- **非正式**: 使用轻松、口语化的表达

**注意**: 仅 AI 服务（OpenAI, Claude, Gemini）支持风格设置

### 专业领域

选择翻译内容的专业领域，提高专业术语翻译准确度：
- 通用（默认）
- 技术
- 医学
- 法律
- 金融

**注意**: 主要由 AI 服务支持

### 并行翻译

启用后，同时调用多个翻译服务，可以：
- 对比不同服务的翻译结果
- 选择最佳翻译
- 了解各服务的质量差异

**注意**: 会增加 API 调用成本

### 语言对偏好

为特定的语言对指定首选服务：
- 中文 ↔ 英文 → 百度翻译
- 英文 ↔ 德文 → DeepL
- 日文 ↔ 中文 → 有道翻译

## 📊 服务选择策略

### 自动智能选择

系统会根据以下因素自动选择最佳服务：

1. **语言对匹配**
   - 中英互译 → 百度/有道
   - 欧洲语言 → DeepL
   - 其他语言 → Google

2. **文本长度**
   - 短文本（< 100 字符）→ 快速服务（Gemini, GPT-3.5）
   - 长文本（> 1000 字符）→ AI 服务（Claude, GPT-4）

3. **配额情况**
   - 优先使用有剩余配额的服务
   - 避免使用已耗尽配额的服务

### 手动选择优先级

1. 用户在翻译时指定的服务（未来支持）
2. 语言对偏好设置
3. 智能推荐
4. 主要服务设置
5. 第一个可用的服务

## 🔄 自动降级机制

当翻译失败时，系统会自动尝试备用服务：

```
主服务 (DeepL) 失败
  ↓
备用服务 1 (Google) 尝试
  ↓
备用服务 2 (百度) 尝试
  ↓
备用服务 3 (Gemini) 尝试
  ↓
全部失败 → 显示错误
```

### 不会触发降级的错误

- API Key 无效（401, 403）
- 不支持的语言对（400）
- 用户主动取消

### 会触发降级的错误

- 网络超时
- 服务器错误（500, 502, 503）
- 配额超限（429）
- 请求速率限制

## 📈 使用统计

### 查看统计

在"使用统计"标签页可以看到：

**总体统计**:
- 总请求数
- 成功率
- 翻译字符数
- 预估成本

**今日统计**:
- 今日请求数
- 今日字符数
- 今日成本

**各服务统计**:
- 每个服务的使用次数
- 成功率
- 平均响应时间
- 错误记录

**缓存统计**:
- 缓存条目数
- 缓存使用率

### 导出统计

点击"导出统计"可以下载 JSON 格式的统计数据，用于：
- 成本分析
- 服务质量评估
- 使用习惯分析

## 💡 最佳实践

### 1. 服务组合推荐

**免费用户**:
```
主服务: Gemini Flash (免费)
备用: 百度翻译 (5万/月) → DeepL Free (50万/月)
```

**付费用户（高质量）**:
```
主服务: DeepL Pro
备用: OpenAI GPT-4 → Google Translate
```

**付费用户（高性价比）**:
```
主服务: 腾讯翻译
备用: 百度翻译 → Google Translate
```

**AI 优先用户**:
```
主服务: Claude Sonnet
备用: OpenAI GPT-4 → Gemini Pro
```

### 2. 成本控制

- 日常使用选择免费服务（Gemini Flash）
- 重要翻译使用付费服务（DeepL, GPT-4）
- 启用缓存减少重复调用
- 设置配额预警

### 3. 质量优化

- 专业内容使用 AI 服务
- 启用"专业领域"设置
- 使用"并行翻译"对比结果
- 为常用语言对设置偏好服务

### 4. 速度优化

- 主服务选择响应快的服务（Gemini, GPT-3.5）
- 启用缓存
- 减少备用服务数量

## 🔧 故障排除

### API Key 验证失败

**Google Translate**:
- 确保 API Key 格式正确
- 检查 Cloud Translation API 是否启用
- 确认账单已启用

**DeepL**:
- Free API Key 必须以 `:fx` 结尾
- Pro API Key 不带后缀
- 检查账户状态

**OpenAI**:
- API Key 以 `sk-` 开头
- 检查账户余额
- 确认 API 访问权限

**百度/有道/腾讯**:
- 检查 APP ID/Secret 配对是否正确
- 确认账户状态
- 查看 API 文档的错误码说明

### 翻译失败

1. 检查网络连接
2. 查看浏览器控制台错误信息
3. 验证 API Key 是否有效
4. 检查配额是否耗尽
5. 尝试切换其他服务

### 样式显示异常

1. 重新加载扩展
2. 刷新网页
3. 检查浏览器控制台是否有 CSS 加载错误

## 📱 API Key 获取教程

### Google Cloud Translation API

1. 访问 https://console.cloud.google.com
2. 创建新项目或选择现有项目
3. 启用 Cloud Translation API
4. 创建 API 密钥（凭据 → API 密钥）
5. 复制密钥到插件配置

### DeepL API

1. 访问 https://www.deepl.com/pro-api
2. 注册账号（免费或付费）
3. 在账户页面查看 API Key
4. 复制密钥（Free 版以 `:fx` 结尾）

### OpenAI API

1. 访问 https://platform.openai.com
2. 注册并登录账号
3. 进入 API Keys 页面
4. 创建新的 API Key
5. 复制密钥（以 `sk-` 开头）

### 百度翻译 API

1. 访问 https://fanyi-api.baidu.com
2. 注册并登录百度账号
3. 开通翻译服务
4. 创建应用获取 APP ID 和密钥
5. 在插件中输入 APP ID 和密钥

### 有道翻译 API

1. 访问 https://ai.youdao.com
2. 注册并登录账号
3. 创建应用
4. 获取应用 ID 和应用密钥
5. 在插件中输入配置

### Google Gemini API

1. 访问 https://ai.google.dev
2. 点击 "Get API key"
3. 创建或选择项目
4. 生成 API Key
5. 复制密钥到插件

### Anthropic Claude API

1. 访问 https://console.anthropic.com
2. 注册并申请 API 访问权限
3. 在 API Keys 页面创建密钥
4. 复制密钥到插件

## 🎓 使用场景示例

### 场景 1: 日常网页浏览（免费）

**配置**:
- 主服务: Gemini Flash
- 备用: 百度翻译

**说明**: 完全免费，适合日常使用

### 场景 2: 专业文档翻译

**配置**:
- 主服务: DeepL Pro
- 备用: OpenAI GPT-4
- 启用: 专业领域设置（技术/医学等）

**说明**: 最高质量，适合重要文档

### 场景 3: 学习外语

**配置**:
- 主服务: 有道翻译
- 备用: Google Translate
- 启用: 并行翻译对比

**说明**: 可以对比多个翻译结果，学习不同表达

### 场景 4: 大量翻译需求

**配置**:
- 主服务: 腾讯翻译
- 备用: 百度翻译 → Microsoft
- 启用: 缓存

**说明**: 性价比最高，成本最低

## 📊 成本估算

### 每月 10 万字符翻译成本对比

| 服务 | 成本 | 说明 |
|------|------|------|
| Gemini Flash | $0 | 完全免费 |
| 百度翻译 | ¥0 (5万以内) | 超出按 ¥49/百万 |
| 腾讯翻译 | ¥0 (500万以内) | 最便宜 |
| DeepL Free | $0 (50万以内) | 质量最高 |
| Google | $2 | 稳定可靠 |
| Microsoft | $1 (200万以内) | 企业级 |
| OpenAI GPT-3.5 | ~$0.4 | AI 翻译 |
| OpenAI GPT-4 | ~$6 | 最高质量 |
| Claude Sonnet | ~$2.2 | 长文本优秀 |

## 🔐 安全提示

1. **API Key 加密存储**: 所有密钥加密保存在浏览器本地
2. **不要分享密钥**: API Key 是个人凭证，不要泄露
3. **定期更换**: 建议定期更换 API Key
4. **监控使用**: 定期查看使用统计，防止异常
5. **限制权限**: 在服务商处设置 API Key 的使用限制

## 📞 技术支持

### 常见问题

**Q: 如何选择最适合我的服务？**
A: 根据需求选择：质量优先选 DeepL/GPT-4，成本优先选 Gemini/腾讯，中文优先选百度/有道

**Q: 可以同时启用多个服务吗？**
A: 可以，系统会根据场景自动选择最合适的服务

**Q: 备用服务如何工作？**
A: 当主服务失败时，自动尝试备用服务，直到成功或全部失败

**Q: 缓存如何工作？**
A: 相同的文本和语言对会使用缓存结果，默认缓存 24 小时

**Q: 如何控制成本？**
A: 使用免费服务、启用缓存、设置配额预警、查看使用统计

## 🎉 更新日志

### v0.2.0 (2025-10-11)

**新功能**:
- ✅ 支持 9 种翻译服务
- ✅ 自动降级容错机制
- ✅ 智能服务选择
- ✅ 详细使用统计
- ✅ 配额监控
- ✅ 并行翻译对比
- ✅ 翻译风格和领域设置

**架构升级**:
- ✅ 采用 DIP（依赖倒置原则）设计
- ✅ 适配器模式，易于扩展
- ✅ 完整的错误处理
- ✅ LRU 缓存策略

---

**开始使用多翻译引擎，享受更好的翻译体验！** 🚀
